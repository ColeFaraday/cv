\documentclass[11pt,letter,sans]{moderncv}

\usepackage{longtable}
\usepackage{anyfontsize} % arbitrary font size support
\usepackage{footmisc} % footnote support
\setlength{\LTleft}{0pt}
\definecolor{tab_highlight}{HTML}{f0c967}

% % Page numbers
% \usepackage{fancyhdr}
% \pagestyle{fancy}
% \fancyfoot{} % clear existing footer settings
% \fancyfoot[R]{\thepage}

\moderncvcolor{<< color >>}
\definecolor{color2}{rgb}{<<color2>>}
\moderncvstyle{<< style >>}
\colorlet{firstnamecolor}{color1}

\usepackage[top=1in, bottom=1in, left=.7in, right=.7in]{geometry}


\newcommand*\publistbasestyle{nature}


% for the bibliography
\usepackage[defernumbers=true,backend=biber, maxbibnames=99, giveninits=true, style=publist, url=true, doi=true, isbn=true, plauthorhandling=highlight, plsorting=ymdDnt, marginyear=true]{biblatex}

% For some reason the default sorting does not work. This correctly sorts by day as well (useful for manually ordering items in the same month).
% See: https://tex.stackexchange.com/questions/46868/biblatex-sorting-by-date, https://github.com/plk/biblatex/issues/1292#issuecomment-1643875311
\DeclareSortingTemplate{ymdDnt}{
  \sort{
    \field{presort}
  }
  \sort[final]{
    \field{sortkey}
  }
  \sort[direction=descending]{
    \field{sortyear}
    \field{year}
    \literal{9999}
  }
  \sort[direction=descending]{
    \field[padside=left,padwidth=2,padchar=0]{month}
    \literal{99}
  }
  \sort[direction=descending]{
    \field[padside=left,padwidth=2,padchar=0]{day}
    \literal{99}
  }
  \sort{
    \field{sortname}
    \field{author}
    \field{sorttitle}
    \field{title}
  }
  \sort{
    \field{sorttitle}
  }
  \sort[direction=descending]{
    \field[padside=left,padwidth=4,padchar=0]{volume}
    \literal{9999}
  }
}


\plauthorname[Coleridge]{Faraday}
\addbibresource{publications/<< all_publications.file >>}
\addbibresource{publications/<< all_publications.talk_file >>}

\normalmarginpar

% Puts the year in the right margin instead of the left
\renewcommand*\plmarginyear[1]{%
\raggedright\small\textbf{#1}%
}

\renewbibmacro*{date}{%
  \iffieldundef{month}
    {}
    {\mkbibmonth{\thefield{month}}\space}%
  \iffieldundef{year}
    {}
    {\thefield{year}}%
}

% https://tex.stackexchange.com/questions/313307/mastersthesis-entry-results-in-ma-thesis-output-instead-of-masters-thesis
\DefineBibliographyStrings{english}{%
  mathesis = {M.Sc.\ thesis},
}

% \DeclareBibliographyDriver{misc}{%
%   \usebibmacro{bibindex}%
%   \usebibmacro{begentry}%
%   \printfield{title}%
%   \setunit{\addcomma\space}%
%   \printfield{eventtitle}%
%   \setunit{\addcolon\space}%
%   \printlist{location}%
%   \setunit{\space}%
%   \printtext{(}%
%   \usebibmacro{date}%
%   \printtext{)}%
%   \usebibmacro{finentry}}


% \DeclareBibliographyDriver{misc}{%
%   \usebibmacro{bibindex}%
%   \usebibmacro{begentry}%
%   \printfield{title}%
%   \setunit{\addcomma\space}%
%   \printfield{eventtitle}%
%   \setunit{\addcolon\space}%
%   \printlist{location}%
%   \setunit{\space}%
%   \printtext{(}%
%   \usebibmacro{date}%
%   \printtext{)}%
%   \usebibmacro{finentry}}



% Define filled heart symbol
\DeclareSymbolFont{extraup}{U}{zavm}{m}{n}
\DeclareMathSymbol{\varheart}{\mathalpha}{extraup}{86}

\usepackage{mathabx} % For \bigstar

% Use the new X logo (aka a sans-serif blackboard X)
\usepackage{bbm}
\renewcommand*{\twittersocialsymbol}{$\mathbbmss{X}$~}

% Use symbols for footnotes
\renewcommand{\thefootnote}{\fnsymbol{footnote}}

% \usepackage{lastpage}
% \cfoot{\addressfont\textcolor{gray}{Page \thepage\ of \pageref*{LastPage}}}

\AtEndPreamble{\hypersetup{pdftitle={<< name.first >> << name.last >>: CV}, allcolors=color1, colorlinks}}
\name{<< name.first >>}{<< name.last >>}
\email{<< email >>}
\homepage{<< url >>}
\social[orcid]{<< social.orcid >>}
% \social[inspire]{<< social.inspirehep_id >>}
% \social[linkedin]{<<social.linkedin>>}
% \social[twitter]{colefaraday}
\social[inspire]{<< social.inspirehep_id >>} % NB: I have a modified version of moderncv since the Inspire link is incorrect (authoris -> authors)
\social[arxiv]{<< social.arxiv >>}
% \social[github]{<<social.github>>}
% \social[arxiv]{<< social.arxiv >>}
\extrainfo{\small Last updated on \today}

\frenchspacing

\begin{document}
\nocite{*}
\makecvtitle
\vspace{-1cm}

<< body >>

\end{document}
